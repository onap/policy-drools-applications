#
#
# This is test set that tests configurable SQL PIP engine. It uses sample data from MySQL world database
#
# http://dev.mysql.com/doc/world-setup/en/index.html
#
# The Policy was created using the PAP Admin Tool.
#
#

#
# Default XACML Properties File
# Standard API Factories
#
xacml.dataTypeFactory=com.att.research.xacml.std.StdDataTypeFactory
xacml.pdpEngineFactory=com.att.research.xacmlatt.pdp.ATTPDPEngineFactory
xacml.pepEngineFactory=com.att.research.xacml.std.pep.StdEngineFactory
xacml.pipFinderFactory=com.att.research.xacml.std.pip.StdPIPFinderFactory
xacml.traceEngineFactory=com.att.research.xacml.std.trace.LoggingTraceEngineFactory
#
# AT&T PDP Implementation Factories
#
xacml.att.evaluationContextFactory=com.att.research.xacmlatt.pdp.std.StdEvaluationContextFactory
xacml.att.combiningAlgorithmFactory=com.att.research.xacmlatt.pdp.std.StdCombiningAlgorithmFactory
xacml.att.functionDefinitionFactory=com.att.research.xacmlatt.pdp.std.StdFunctionDefinitionFactory
xacml.att.policyFinderFactory=com.att.research.xacmlatt.pdp.std.StdPolicyFinderFactory

#
# NOTE: If you are testing against a RESTful PDP, then the PDP must be configured with the
# policies and PIP configuration as defined below. Otherwise, this is the configuration that
# the embedded PDP uses.
#

# Policies to load
#
xacml.rootPolicies=sql
sql.file=src/test/resources/xacml/frequency_limiter_3.xml

# PIP Engine Definition
#
xacml.pip.engines=sql1

sql1.classname=com.att.research.xacml.std.pip.engines.jdbc.JDBCEngine
sql1.name=OperationsHistory
sql1.description=Database of operations performed via closed loop.
sql1.issuer=com:att:research:xacml:test:sql123
sql1.type=jdbc
sql1.jdbc.driver=org.mariadb.jdbc.Driver
sql1.jdbc.url=jdbc:mariadb://localhost:7779/policy
sql1.jdbc.conn.user=root
sql1.jdbc.conn.password=lmpg

#Each of the following resolvers corresponds to a specific time window. The only difference between them is the "interval" in the "select" SQL query and the "issuer".
sql1.resolvers=tw10min,tw1h,tw100h

##############################################
sql1.resolver.tw10min.select=select count(*) as count from operationshistory10 where outcome<>'Failure_Guard' and actor=? and operation=? and target=? and endtime between date_sub(now(),interval 10 minute) and now()
sql1.resolver.tw10min.field.count.issuer=com:att:research:xacml:test:sql:tw10min

sql1.resolver.tw10min.classname=com.att.research.xacml.std.pip.engines.jdbc.ConfigurableJDBCResolver
sql1.resolver.tw10min.name=OperationsCount
sql1.resolver.tw10min.description=This returns the number of previous operations within the given time window
sql1.resolver.tw10min.fields=count
sql1.resolver.tw10min.field.count.id=com:att:research:xacml:test:sql:resource:operations:count
sql1.resolver.tw10min.field.count.datatype=http://www.w3.org/2001/XMLSchema#integer
sql1.resolver.tw10min.field.count.category=urn:oasis:names:tc:xacml:3.0:attribute-category:resource
sql1.resolver.tw10min.parameters=actor,operation,target
sql1.resolver.tw10min.parameter.actor.id=urn:oasis:names:tc:xacml:1.0:actor:actor-id
sql1.resolver.tw10min.parameter.actor.datatype=http://www.w3.org/2001/XMLSchema#string
sql1.resolver.tw10min.parameter.actor.category=urn:oasis:names:tc:xacml:1.0:subject-category:access-subject
sql1.resolver.tw10min.parameter.operation.id=urn:oasis:names:tc:xacml:1.0:operation:operation-id
sql1.resolver.tw10min.parameter.operation.datatype=http://www.w3.org/2001/XMLSchema#string
sql1.resolver.tw10min.parameter.operation.category=urn:oasis:names:tc:xacml:3.0:attribute-category:action
sql1.resolver.tw10min.parameter.target.id=urn:oasis:names:tc:xacml:1.0:target:target-id
sql1.resolver.tw10min.parameter.target.datatype=http://www.w3.org/2001/XMLSchema#string
sql1.resolver.tw10min.parameter.target.category=urn:oasis:names:tc:xacml:3.0:attribute-category:resource

##############################################
sql1.resolver.tw1h.select=select count(*) as count from operationshistory10 where actor=? and operation=? and target=? and endtime between date_sub(now(),interval 1 hour) and now()
sql1.resolver.tw1h.field.count.issuer=com:att:research:xacml:test:sql:tw1h

sql1.resolver.tw1h.classname=com.att.research.xacml.std.pip.engines.jdbc.ConfigurableJDBCResolver
sql1.resolver.tw1h.name=OperationsCount
sql1.resolver.tw1h.description=This returns the number of previous operations within the given time window
sql1.resolver.tw1h.fields=count
sql1.resolver.tw1h.field.count.id=com:att:research:xacml:test:sql:resource:operations:count
sql1.resolver.tw1h.field.count.datatype=http://www.w3.org/2001/XMLSchema#integer
sql1.resolver.tw1h.field.count.category=urn:oasis:names:tc:xacml:3.0:attribute-category:resource
sql1.resolver.tw1h.parameters=actor,operation,target
sql1.resolver.tw1h.parameter.actor.id=urn:oasis:names:tc:xacml:1.0:actor:actor-id
sql1.resolver.tw1h.parameter.actor.datatype=http://www.w3.org/2001/XMLSchema#string
sql1.resolver.tw1h.parameter.actor.category=urn:oasis:names:tc:xacml:1.0:subject-category:access-subject
sql1.resolver.tw1h.parameter.operation.id=urn:oasis:names:tc:xacml:1.0:operation:operation-id
sql1.resolver.tw1h.parameter.operation.datatype=http://www.w3.org/2001/XMLSchema#string
sql1.resolver.tw1h.parameter.operation.category=urn:oasis:names:tc:xacml:3.0:attribute-category:action
sql1.resolver.tw1h.parameter.target.id=urn:oasis:names:tc:xacml:1.0:target:target-id
sql1.resolver.tw1h.parameter.target.datatype=http://www.w3.org/2001/XMLSchema#string
sql1.resolver.tw1h.parameter.target.category=urn:oasis:names:tc:xacml:3.0:attribute-category:resource


#############################
sql1.resolver.tw100h.select=select count(*) as count from operationshistory10 where actor=? and operation=? and target=? and endtime between date_sub(now(),interval 100 hour) and now()
sql1.resolver.tw100h.field.count.issuer=com:att:research:xacml:test:sql:tw100h

sql1.resolver.tw100h.classname=com.att.research.xacml.std.pip.engines.jdbc.ConfigurableJDBCResolver
sql1.resolver.tw100h.name=OperationsCount
sql1.resolver.tw100h.description=This returns the number of previous operations within the given time window
sql1.resolver.tw100h.fields=count
sql1.resolver.tw100h.field.count.id=com:att:research:xacml:test:sql:resource:operations:count
sql1.resolver.tw100h.field.count.datatype=http://www.w3.org/2001/XMLSchema#integer
sql1.resolver.tw100h.field.count.category=urn:oasis:names:tc:xacml:3.0:attribute-category:resource
sql1.resolver.tw100h.parameters=actor,operation,target
sql1.resolver.tw100h.parameter.actor.id=urn:oasis:names:tc:xacml:1.0:actor:actor-id
sql1.resolver.tw100h.parameter.actor.datatype=http://www.w3.org/2001/XMLSchema#string
sql1.resolver.tw100h.parameter.actor.category=urn:oasis:names:tc:xacml:1.0:subject-category:access-subject
sql1.resolver.tw100h.parameter.operation.id=urn:oasis:names:tc:xacml:1.0:operation:operation-id
sql1.resolver.tw100h.parameter.operation.datatype=http://www.w3.org/2001/XMLSchema#string
sql1.resolver.tw100h.parameter.operation.category=urn:oasis:names:tc:xacml:3.0:attribute-category:action
sql1.resolver.tw100h.parameter.target.id=urn:oasis:names:tc:xacml:1.0:target:target-id
sql1.resolver.tw100h.parameter.target.datatype=http://www.w3.org/2001/XMLSchema#string
sql1.resolver.tw100h.parameter.target.category=urn:oasis:names:tc:xacml:3.0:attribute-category:resource


