{
  "comments": [
    {
      "key": {
        "uuid": "f9c47dec_fbb42303",
        "filename": "controlloop/common/controller-usecases/src/main/java/org/onap/policy/drools/apps/controller/usecases/step/GuardStep2.java",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 811
      },
      "writtenOn": "2020-08-28T17:17:34Z",
      "side": 1,
      "message": "Nice!",
      "revId": "6110e83b83e071e92b216eab09177123f6e9a736",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "34d2ad0c_9b95a269",
        "filename": "controlloop/common/controller-usecases/src/main/java/org/onap/policy/drools/apps/controller/usecases/step/GuardStep2.java",
        "patchSetId": 5
      },
      "lineNbr": 96,
      "author": {
        "id": 811
      },
      "writtenOn": "2020-08-28T17:17:34Z",
      "side": 1,
      "message": "maybe only add these if it\u0027s PNF?",
      "revId": "6110e83b83e071e92b216eab09177123f6e9a736",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a342f279_4d553aeb",
        "filename": "controlloop/common/controller-usecases/src/main/java/org/onap/policy/drools/apps/controller/usecases/step/GuardStep2.java",
        "patchSetId": 5
      },
      "lineNbr": 96,
      "author": {
        "id": 57
      },
      "writtenOn": "2020-08-28T17:51:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "34d2ad0c_9b95a269",
      "revId": "6110e83b83e071e92b216eab09177123f6e9a736",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "de7386f5_fd4ae99d",
        "filename": "controlloop/common/controller-usecases/src/test/java/org/onap/policy/drools/apps/controller/usecases/step/GuardStep2Test.java",
        "patchSetId": 5
      },
      "lineNbr": 74,
      "author": {
        "id": 811
      },
      "writtenOn": "2020-08-28T17:17:34Z",
      "side": 1,
      "message": "don\u0027t need this",
      "revId": "6110e83b83e071e92b216eab09177123f6e9a736",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b63cb5df_a6419991",
        "filename": "controlloop/common/controller-usecases/src/test/java/org/onap/policy/drools/apps/controller/usecases/step/GuardStep2Test.java",
        "patchSetId": 5
      },
      "lineNbr": 74,
      "author": {
        "id": 57
      },
      "writtenOn": "2020-08-28T17:51:34Z",
      "side": 1,
      "message": "hmm - I get NPE. The methods seem to need the cq to return objects from it.",
      "parentUuid": "de7386f5_fd4ae99d",
      "revId": "6110e83b83e071e92b216eab09177123f6e9a736",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7350a40a_9e758405",
        "filename": "controlloop/common/controller-usecases/src/test/java/org/onap/policy/drools/apps/controller/usecases/step/GuardStep2Test.java",
        "patchSetId": 5
      },
      "lineNbr": 74,
      "author": {
        "id": 811
      },
      "writtenOn": "2020-08-28T18:47:06Z",
      "side": 1,
      "message": "what method needs it?  hmm, maybe need to add preprocessed(true) to the params on line 117",
      "parentUuid": "b63cb5df_a6419991",
      "revId": "6110e83b83e071e92b216eab09177123f6e9a736",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "432e1832_f29c6cfa",
        "filename": "controlloop/common/controller-usecases/src/test/java/org/onap/policy/drools/apps/controller/usecases/step/GuardStep2Test.java",
        "patchSetId": 5
      },
      "lineNbr": 74,
      "author": {
        "id": 57
      },
      "writtenOn": "2020-08-31T10:21:46Z",
      "side": 1,
      "message": "added that but the use usecases.drl breaks - timeouts everywhere.\nWe are adding attributes from the custom query, so not sure why you wouldn\u0027t want to mock it?",
      "parentUuid": "7350a40a_9e758405",
      "revId": "6110e83b83e071e92b216eab09177123f6e9a736",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "663d5c36_6b460b0d",
        "filename": "controlloop/common/controller-usecases/src/test/java/org/onap/policy/drools/apps/controller/usecases/step/GuardStep2Test.java",
        "patchSetId": 5
      },
      "lineNbr": 74,
      "author": {
        "id": 811
      },
      "writtenOn": "2020-08-31T11:05:14Z",
      "side": 1,
      "message": "You are absolutely right - I was mixing up the Operation from the Step.  The Operation only requires the extracted data (e.g., GenericVnf, CloudRegion), but it\u0027s the Step that provides it by pulling from the custom query, so yes, it is required by the Step to make these tests work.\n\nRegarding the timeouts, if you look at the output from UsecasesTest, then you\u0027ll see things like:\njava.lang.IllegalArgumentException: missing vserver.vserver-name in enrichment data\n\tat org.onap.policy.drools.apps.controller.usecases.step.AaiGetTenantStep2.\u003cinit\u003e(AaiGetTenantStep2.java:53)\n\njava.lang.IllegalArgumentException: missing enrichment/vserver.vserver-id for GUARD.Decision\n\tat org.onap.policy.drools.apps.controller.usecases.step.Step2.verifyNotNull(Step2.java:419)\n\nThe first is occurring, because the Guard now requires the custom query in all of the non-PNF cases, but to run the custom query, the Tenant query must be run first.  However, the Tenant query will not work unless the vserver.vserver-name is provided in the enrichment data.  In other words, this will not work unless DCAE provides the vserver.vserver-name for all of the non-PNF cases - currently, our tests only assume it\u0027s provided in certain cases, but maybe DCAE, in reality, always provides it?  If that\u0027s true then we can add it to the onset json files for all of the test cases.\n\nThe second is occurring, because the Decision guard now requires the enrichment data to contain the vserver.vserver-id.  Once again, is this something we always expect DCAE to provide?  If so, then we can simply add it to the onset json files for all of the test cases.  If not, then we\u0027d have to figure out how to get it (perhaps from the output of the custom query?).",
      "parentUuid": "432e1832_f29c6cfa",
      "revId": "6110e83b83e071e92b216eab09177123f6e9a736",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c1d66f35_66ec582f",
        "filename": "controlloop/common/controller-usecases/src/test/java/org/onap/policy/drools/apps/controller/usecases/step/GuardStep2Test.java",
        "patchSetId": 5
      },
      "lineNbr": 74,
      "author": {
        "id": 57
      },
      "writtenOn": "2020-09-01T12:07:56Z",
      "side": 1,
      "message": "Ok thanks for digging in to this. So yes and no, we aren\u0027t guaranteed for DCAE to provide vserver.vserver-name, most likely they will. But if they fail to make the A\u0026AI call (their connection is down), then they won\u0027t send it. So we kind of have to support both situations. Its possible if A\u0026AI is down for DCAE, it is for Policy also. Albeit not necessarily true. I did not see in the custom query where the vserver.vserver-name was. If it isn\u0027t provided, then just sending null should be sufficient. If the attribute is unavailable, then the guard decision comes back DENY. Which would be correct, since we cannot tell and should just err on the safe side. Not sure that vserver.vserver-name is going to be widely used anyway. I could consider not using it.",
      "parentUuid": "663d5c36_6b460b0d",
      "revId": "6110e83b83e071e92b216eab09177123f6e9a736",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bbb1489a_4ff0e78d",
        "filename": "controlloop/common/controller-usecases/src/test/java/org/onap/policy/drools/apps/controller/usecases/step/GuardStep2Test.java",
        "patchSetId": 5
      },
      "lineNbr": 74,
      "author": {
        "id": 57
      },
      "writtenOn": "2020-09-01T12:26:41Z",
      "side": 1,
      "message": "Actually - wait a minute. I did re-check the CQ, and vserver.vserver-id is in there. I better switch to grabbing it from there instead.",
      "parentUuid": "c1d66f35_66ec582f",
      "revId": "6110e83b83e071e92b216eab09177123f6e9a736",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fed21c7a_bd38a451",
        "filename": "controlloop/common/controller-usecases/src/test/java/org/onap/policy/drools/apps/controller/usecases/step/GuardStep2Test.java",
        "patchSetId": 5
      },
      "lineNbr": 103,
      "author": {
        "id": 57
      },
      "writtenOn": "2020-08-31T10:21:46Z",
      "side": 1,
      "message": "These require the custom query and line 106-107",
      "range": {
        "startLine": 100,
        "startChar": 0,
        "endLine": 103,
        "endChar": 63
      },
      "revId": "6110e83b83e071e92b216eab09177123f6e9a736",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "02189f5f_28424a9f",
        "filename": "controlloop/common/controller-usecases/src/test/java/org/onap/policy/drools/apps/controller/usecases/step/GuardStep2Test.java",
        "patchSetId": 5
      },
      "lineNbr": 116,
      "author": {
        "id": 811
      },
      "writtenOn": "2020-08-28T17:17:34Z",
      "side": 1,
      "message": "shouldn\u0027t need this - it\u0027s going away",
      "range": {
        "startLine": 116,
        "startChar": 65,
        "endLine": 116,
        "endChar": 80
      },
      "revId": "6110e83b83e071e92b216eab09177123f6e9a736",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "30cc0e3c_adb03fb1",
        "filename": "controlloop/common/controller-usecases/src/test/java/org/onap/policy/drools/apps/controller/usecases/step/GuardStep2Test.java",
        "patchSetId": 5
      },
      "lineNbr": 116,
      "author": {
        "id": 57
      },
      "writtenOn": "2020-08-28T17:51:34Z",
      "side": 1,
      "message": "changed to new targetType",
      "parentUuid": "02189f5f_28424a9f",
      "range": {
        "startLine": 116,
        "startChar": 65,
        "endLine": 116,
        "endChar": 80
      },
      "revId": "6110e83b83e071e92b216eab09177123f6e9a736",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "51af5fed_1cfce530",
        "filename": "controlloop/common/controller-usecases/src/test/java/org/onap/policy/drools/apps/controller/usecases/step/GuardStep2Test.java",
        "patchSetId": 5
      },
      "lineNbr": 179,
      "author": {
        "id": 811
      },
      "writtenOn": "2020-08-28T17:17:34Z",
      "side": 1,
      "message": "I think sonar will say that these lines should be changed together:\n\n  xxx.containsEntry(...).containsEntry(...)",
      "revId": "6110e83b83e071e92b216eab09177123f6e9a736",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f6e53a87_5c2c89c0",
        "filename": "controlloop/common/controller-usecases/src/test/java/org/onap/policy/drools/apps/controller/usecases/step/GuardStep2Test.java",
        "patchSetId": 5
      },
      "lineNbr": 179,
      "author": {
        "id": 57
      },
      "writtenOn": "2020-08-28T17:51:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "51af5fed_1cfce530",
      "revId": "6110e83b83e071e92b216eab09177123f6e9a736",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    }
  ]
}